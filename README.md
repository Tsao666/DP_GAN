# Apply DP-GAN on Generative-AI Navigation Information Competition for UAV Reconnaissance in Natural Environments

We are TEAM_5101, participants in [this competition](https://tbrain.trendmicro.com.tw/Competitions/Details/34). By combining images generated from the **DP-GAN** and [@Tianming8585](https://github.com/Tianming8585)'s **[PITI](https://github.com/Tianming8585/PITI)** models, we achieved 6th place (FID: 88.8781) on the public dataset and 4th place (FID: 89.0964) on the private dataset. This repository contains the code for DP-GAN and the ensemble model.

[Report](report.md) [Ensemble](ensemble.md)

## Environment

Based on [tensorflow:2.15.0-gpu](https://hub.docker.com/layers/tensorflow/tensorflow/2.15.0-gpu/images/sha256-66b44c162783bb92ab6f44c1b38bcdfef70af20937089deb7bc20a4f3d7e5491?context=explore), and install `torch`, `pandas`, `opencv-python` and `wandb` additionally.

## Preprocessing

Please check [UAV.py](./dataloaders/UAV.py).

## Training

```bash
python train.py --name UAV_instance_512_z128_400 --dataset_mode UAV_34_train --param_free_norm instance --z_dim 128 --num_epochs 400 --gpu_ids 0 --batch_size 8
```

## Generate Images

```bash
python test.py --name UAV_instance_512_z128_400 --dataset_mode UAV_34_public --param_free_norm instance --z_dim 128 --ckpt_iter best --results_dir private --gpu_ids 0 --batch_size 8
```

## Export the Output of D-net

```
python eval_pri.py --name UAV_instance_512_z128_400 --dataset_mode UAV_34_public --param_free_norm instance --z_dim 128 --gpu_ids 0 --ckpt_iter best --results_dir private
```

The command will output the average values of the **fake**, **background**, **RI**, and **RO** classes inferred by the D network for each generated image from different models. Ensure the folder path for the generated images is correctly set before use.

## Ensemble

Use [ensemble.ipynb](./ensemble.ipynb) to set the ensemble rules and combine images generated by different models. Ensure that the outputs from the D-net are exported before use.

## Others

More command examples can be found in [UAV](./scripts/UAV).

## Citation

If you use this work please cite

```
@misc{
  title  = {Apply DP-GAN on Generative-AI Navigation Information Competition for UAV Reconnaissance in Natural Environments},
  author = {Wei-Chun Tsao},
  url    = {https://github.com/Tsao666/DP_GAN},
  year   = {2024}
}
```

## Acknowledgement

This code is based on [DP_GAN](https://github.com/sj-li/DP_GAN)
